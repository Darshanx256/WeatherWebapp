(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))d(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&d(i)}).observe(document,{childList:!0,subtree:!0});function f(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerPolicy&&(n.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?n.credentials="include":l.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function d(l){if(l.ep)return;l.ep=!0;const n=f(l);fetch(l.href,n)}})();document.addEventListener("DOMContentLoaded",function(){const p=document.getElementById("searchInput"),s=document.getElementById("suggestionContainer"),f=document.getElementById("searchButton");let d=0;p.addEventListener("input",function(){const n=this.value.trim().toLowerCase();if(s.innerHTML="",n.length===0){s.style.display="none",d=0;return}const i=new Set;cityData.values.forEach(u=>{u.toLowerCase().startsWith(n)&&i.add(u)});const g=Array.from(i).slice(0,4);if(g.length===0){s.style.display="none",d=-1,document.body.classList.remove("suggestion-open");return}g.forEach((u,E)=>{const h=document.createElement("div");h.textContent=u,h.classList.add("suggestion"),h.addEventListener("click",function(){p.value=u,s.innerHTML="",s.style.display="none",d=-1}),E===d&&h.classList.add("selected"),s.appendChild(h)});const w=p.getBoundingClientRect();s.style.top=w.bottom+window.scrollY+"px",s.style.left=w.left+"px",s.style.width=p.offsetWidth+"px",s.style.display="block"}),p.addEventListener("keydown",function(n){const i=document.querySelectorAll(".suggestion");n.key==="ArrowDown"?(d=Math.min(d+1,i.length-1),l(i)):n.key==="ArrowUp"?(d=Math.max(d-1,-1),l(i)):n.key==="Enter"&&d!==-1?(p.value=i[d].textContent,s.innerHTML="",s.style.display="none",d=-1,f.click()):n.key=="Enter"&&f.click()});function l(n){n.forEach((i,g)=>{g===d?i.classList.add("selected"):i.classList.remove("selected")})}document.addEventListener("click",function(n){!s.contains(n.target)&&n.target!==p&&(s.style.display="none",d=-1)})});const ee="5a088485f78a08fadae18627eec5a98f",te="2cdf21140e974ba8af8fae8dab9bbbb1",ne=Object.freeze(Object.defineProperty({__proto__:null,GEOAPIFY_KEY:te,OPENWEATHERMAP_KEY:ee},Symbol.toStringTag,{value:"Module"})),oe="modulepreload",re=function(p,s){return new URL(p,s).href},R={},ie=function(s,f,d){if(!f||f.length===0)return s();const l=document.getElementsByTagName("link");return Promise.all(f.map(n=>{if(n=re(n,d),n in R)return;R[n]=!0;const i=n.endsWith(".css"),g=i?'[rel="stylesheet"]':"";if(!!d)for(let E=l.length-1;E>=0;E--){const h=l[E];if(h.href===n&&(!i||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${g}`))return;const u=document.createElement("link");if(u.rel=i?"stylesheet":oe,i||(u.as="script",u.crossOrigin=""),u.href=n,document.head.appendChild(u),i)return new Promise((E,h)=>{u.addEventListener("load",E),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>s()).catch(n=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=n,window.dispatchEvent(i),!i.defaultPrevented)throw n})};let x=null,U=null;document.addEventListener("DOMContentLoaded",async()=>{try{const e=await ie(()=>Promise.resolve().then(()=>ne),void 0,import.meta.url);x=e.OPENWEATHERMAP_KEY,U=e.GEOAPIFY_KEY}catch(e){console.log("Error importing API key: ",e)}const p="https://api.openweathermap.org/data/2.5/weather?units=metric",s=document.getElementById("searchInput"),f=document.getElementById("searchButton"),d=document.getElementById("distancecalculator"),l=document.getElementById("gps");var n=document.getElementById("distance-popup");const i=document.getElementById("minimap");var g=document.getElementById("no-network-popup"),w=document.getElementById("loading-popup");let u;f.addEventListener("click",function(){const e=s.value.trim();e&&M(e)}),l.addEventListener("click",function(){P()}),d.addEventListener("click",function(){n.innerHTML="",populateDynamicContent();var e=document.createElement("script");e.src="modules/distance/dist.js",document.body.appendChild(e),n.style.display="block",window.scrollBy(0,500)});function E(e,t){let o=JSON.parse(localStorage.getItem("searchHistory"))||[];const r=o.findIndex(c=>c.query===e);r!==-1&&o.splice(r,1);const a=30;o.length>=a&&o.shift(),o.push({query:e,temperature:t}),localStorage.setItem("searchHistory",JSON.stringify(o))}function h(){console.log("showSearchHistory function called");const e=JSON.parse(localStorage.getItem("searchHistory"))||[],t=document.getElementById("historyTableBody");if(t.innerHTML="",e.length===0){const r=document.createElement("tr");r.innerHTML="<td >NO HISTORY</td>",t.appendChild(r)}else for(let r=e.length-1;r>=0;r--){const a=e[r],c=document.createElement("tr");c.innerHTML=`
                    <td>${a.query}</td>
                    <td>${a.temperature}°C</td>
                    <td>
                        <button class="delete-btn" data-index="${r}">x</button>
                        <button class="hist-load" data-index="${r}">LOAD NOW</button>
                    </td>
                `,t.appendChild(c)}const o=document.getElementById("history");o.classList.add("show"),console.log("Search history visibility toggled:",o.classList.contains("show"))}function F(e){let t=JSON.parse(localStorage.getItem("searchHistory"))||[];t.splice(e,1),localStorage.setItem("searchHistory",JSON.stringify(t)),h()}function Y(e){let t=JSON.parse(localStorage.getItem("searchHistory"))||[];console.log(t[e].query),$(),s.value=t[e].query,f.click()}document.getElementById("history-btn").addEventListener("click",function(){console.log("History button clicked"),h()}),document.getElementById("historyTableBody").addEventListener("click",function(e){if(e.target.classList.contains("delete-btn")){const t=e.target.dataset.index;F(t)}if(e.target.classList.contains("hist-load")){const t=e.target.dataset.index;Y(t)}});function $(){document.getElementById("history").classList.remove("show")}document.getElementById("closeHistoryBtn").addEventListener("click",function(){$()});function P(e){console.log("Attempting to get GPS location..."),navigator.geolocation?navigator.geolocation.getCurrentPosition(async function(t){console.log("GPS location acquired successfully.");const o=t.coords.latitude,r=t.coords.longitude;try{const a=`https://api.openweathermap.org/data/2.5/weather?lat=${o}&lon=${r}&appid=${x}`,c=await fetch(a);if(c.ok){const m=(await c.json()).name;console.log("City Name:",m),M(m),w.style.display="none"}else console.error("Error fetching weather data:",c.statusText),g.style.display="block",w.style.display="none"}catch(a){console.error("Error fetching weather data:",a),g.style.display="block",w.style.display="none"}},function(t){console.error("Error getting current position:",t),g.style.display="block",w.style.display="none"}):console.error("Geolocation is not supported by this browser.")}w.style.display="block",P();function z(e,t){const o="https://maps.geoapify.com/v1/staticmap",r=new URLSearchParams({style:"osm-bright",width:420,height:230,center:`lonlat:${t},${e}`,zoom:8,apiKey:U,marker:`lonlat:${t},${e};color:red;size:medium`}),a=`${o}?${r}`;return console.log(a),a}async function M(e){try{const t=await fetch(`${p}&appid=${x}&q=${e}`);t.ok||(g.style.display="block");const o=await t.json();console.log(o),K(o),E(S(o.name),o.main.temp)}catch(t){console.log(t)}}function K(e){u&&clearInterval(u,e.weather[0].main),i.src="",Q(e.name),mapAddr=z(e.coord.lat,e.coord.lon),i.src=mapAddr,console.log(e.timezone);const t=document.querySelector(".weather-icon");t.src=`http://openweathermap.org/img/w/${e.weather[0].icon}.png`,t.alt=e.weather[0].main,u=setInterval(function(){j(e.timezone,e.weather[0].main)},1e3),document.querySelector(".city").textContent=S(e.name),document.querySelector(".temp").textContent=e.main.temp+" °C",document.querySelector(".humidity").textContent=e.main.humidity+"%",document.querySelector(".wind").textContent=e.wind.speed+" km/h",document.querySelector(".max").textContent=e.main.temp_max+" °C",document.querySelector(".min").textContent=e.main.temp_min+" °C",document.querySelector(".weather-icon").textContent=e.weather[0].main,document.querySelector(".pressure").textContent=e.main.pressure+" hPa",document.querySelector(".visibility").textContent=e.visibility+" km",e.main.sea_level!==void 0&&(document.querySelector(".sea-level").textContent=e.main.sea_level+" m"),document.querySelector(".new-weather").textContent=S(e.weather[0].description),document.querySelector(".country").textContent=S(e.sys.country)}function S(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}function j(e,t){const o=new Date,r=e*1e3,a=new Date(o.getTime()+r),y=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][a.getUTCDay()];let m=a.getUTCHours(),C=a.getUTCMinutes(),L="";m>=5&&m<12?L="Morning":m>=12&&m<17?L="Afternoon":m>=17&&m<21?L="Evening":L="Night";let H=m>=12?"PM":"AM";m=m%12||12,C=C<10?"0"+C:C;const B=document.getElementById("time"),v=document.getElementById("date");B.textContent=`${m}:${C} ${H}`,v.textContent=`${y} - ${a.toLocaleDateString()}`,document.getElementById("timeOfDay").textContent=`${L}`}var D=document.getElementById("weatherForecast"),b=document.getElementById("weatherForecastWrapper"),k=document.getElementById("loadingIndicator"),I=null,T=0,q=40;function _(){if(!(!I||!I.list)){var e=G(I.list.slice(T,T+q));e.forEach(function(t,o,r){var a=J(o,t,r);D.appendChild(a)}),k.style.display="none"}}function G(e){var t=new Map;return e.forEach(function(o,r){var a=new Date(o.dt*1e3).toLocaleDateString();t.has(a)||t.set(a,[]),t.get(a).push(o)}),t}function J(e,t,o){var r=document.createElement("table");r.classList.add("weather-table");var a=document.createElement("caption");return a.textContent=Z(e,o),r.appendChild(a),t.forEach(function(c){var y=r.insertRow(),m=y.insertCell(),C=y.insertCell(),L=y.insertCell(),H=new Date(c.dt*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});m.textContent=H;var B=c.main.temp+"°C";C.textContent=B;var v=document.createElement("img");c.weather&&c.weather.length>0&&c.weather[0].icon?(v.src="https://openweathermap.org/img/wn/"+c.weather[0].icon+".png",v.alt="Weather Icon",v.title=c.weather[0].description):(v.src="placeholder.png",v.alt="Placeholder Icon"),v.classList.add("weather-icon"),L.appendChild(v);var A=document.createElement("span");A.textContent=c.weather[0].description,L.appendChild(A),y.addEventListener("click",function(){if(y.nextElementSibling&&y.nextElementSibling.classList.contains("weather-details"))y.nextElementSibling.classList.toggle("show"),y.nextElementSibling.classList.toggle("active");else{var N=r.insertRow(y.rowIndex+1);N.classList.add("weather-details","show","active");var W=N.insertCell();W.colSpan=3;var O=document.createElement("div");O.classList.add("weather-details-content"),O.innerHTML=`
                        <div style="display: flex; justify-content: space-between;">
                            <div style="flex: 1;">
                                <p><i class="fas fa-tint"></i> Humidity: ${c.main.humidity}%</p>
                                <p><i class="fas fa-wind"></i> Wind Speed: ${c.wind.speed} m/s</p>
                                <p><i class="fas fa-tachometer-alt"></i> Pressure: ${c.main.pressure} hPa</p>
                            </div>
                            <div style="flex: 1;">
                                <p><i class="fas fa-thermometer-half"></i> Feels Like: ${c.main.feels_like}°C</p>
                                <p><i class="fas fa-thermometer-full"></i> Max Temp: ${c.main.temp_max}°C</p>
                                <p><i class="fas fa-thermometer-empty"></i> Min Temp: ${c.main.temp_min}°C</p>
                            </div>
                        </div>
                    `,W.appendChild(O)}})}),r}function V(){T+=q,_()}function X(){b.scrollHeight-b.scrollTop===b.clientHeight&&(k.style.display="block",V())}b.addEventListener("scroll",X);function Q(e){D.innerHTML="",k.style.display="block";var t=`https://api.openweathermap.org/data/2.5/forecast?appid=${x}&units=metric&q=`+e;fetch(t).then(o=>o.json()).then(o=>{console.log(o),I=o,_()}).catch(o=>console.error("Error fetching weather data:",o))}function Z(e,t){if(t===0)return"Today - "+e;if(t===1)return"Tomorrow - "+e;if(t===2)return"Day after Tomorrow - "+e;var o={weekday:"long",year:"numeric",month:"long",day:"numeric"},r=new Date(e);return r.toLocaleDateString("en-US",o)}});
